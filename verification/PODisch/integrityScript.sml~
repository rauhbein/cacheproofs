(* =============   Simulation relation    ==========================*)

val simul_def = Define `simul  rs is = 
  (equal_user_register s t)           /\
  (s.coprocessors  = t.coprocessors)  /\
  (mmu_equiv s t)                     /\
  (!req:word2 pa:word32. 
     (mmu_access_req s.coprocessors.c1 s.coprocessors.c2 s.coprocessors.c3 s.memory s.cache F pa req) ==> 
      (
      let ((v1,c1), m1) = READ (s.memory, s.cache, pa)           in
      let ((v2,c2), m2) = READ (t.memory, t.cache, pa)           in
	  (m1 = m2) /\ ((v1, c1) = (v2, c2))
      )
  )
`;
