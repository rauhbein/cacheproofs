(* cacheScript.sml - generated by L3 - Mon Dec 04 11:53:00 2017 *)
open HolKernel boolLib bossLib Import

val () = Import.start "cache"

val _ = Record ("wrTyp",[("flag",bTy),("value",F32)])
;
val _ = Record
  ("CCSIDR",
   [("Associativity",FTy 10),("LineSize",FTy 3),("NumSets",FTy 15),
    ("RA",bTy),("WA",bTy),("WB",bTy),("WT",bTy)])
;
val _ = Record
  ("CSSELR_EL1",[("InD",bTy),("Level",FTy 3),("RES0",FTy 28)])
;
val _ = Record
  ("CTR",
   [("CWG",F4),("DminLine",F4),("ERG",F4),("IminLine",F4),("L1Ip",FTy 2),
    ("RES00",FTy 3),("RES01",FTy 10),("RES1",bTy)])
;
val _ = Record
  ("CACHE_CONFIG",
   [("ccsidr",CTy"CCSIDR"),("csselr_el1",CTy"CSSELR_EL1"),("ctr",CTy"CTR")])
;
val _ = Record ("SLVAL",[("dirty",bTy),("value",ATy(FTy 48,F32))])
;
val _ = Construct
  [("actions",[("a_read",[]),("a_write",[]),("a_evict",[]),("a_lfill",[])])]
;
val _ = Record
  ("CSET",
   [("hist",LTy(PTy(CTy"actions",PTy(nTy,FTy 48)))),
    ("sl",ATy(FTy 48,OTy(CTy"SLVAL")))])
;
val _ = Construct
  [("exception",[("NoException",[]),("CACHE_WRITE_FAULT",[])])]
;
val _ = Record
  ("cache_state",[("DC",CTy"CACHE_CONFIG"),("exception",CTy"exception")])
;
val qTy = CTy "cache_state";
fun qVar v = Term.mk_var (v, ParseDatatype.pretypeToType qTy);
val raise'exception_def = Def
  ("raise'exception",Var("e",CTy"exception"),
   Close
     (qVar"state",
      TP[LX(VTy"a"),
         ITE(EQ(Dest("exception",CTy"exception",qVar"state"),
                Const("NoException",CTy"exception")),
             Rupd("exception",TP[qVar"state",Var("e",CTy"exception")]),
             qVar"state")]))
;
val rec'CCSIDR_def = Def
  ("rec'CCSIDR",Var("x",F32),
   Rec(CTy"CCSIDR",
       [EX(Var("x",F32),LN 12,LN 3,FTy 10),
        EX(Var("x",F32),LN 2,LN 0,FTy 3),
        EX(Var("x",F32),LN 27,LN 13,FTy 15),Bop(Bit,Var("x",F32),LN 29),
        Bop(Bit,Var("x",F32),LN 28),Bop(Bit,Var("x",F32),LN 30),
        Bop(Bit,Var("x",F32),LN 31)]))
;
val reg'CCSIDR_def = Def
  ("reg'CCSIDR",Var("x",CTy"CCSIDR"),
   CS(Var("x",CTy"CCSIDR"),
      [(Rec(CTy"CCSIDR",
            [Var("Associativity",FTy 10),Var("LineSize",FTy 3),
             Var("NumSets",FTy 15),bVar"RA",bVar"WA",bVar"WB",bVar"WT"]),
        CC[Mop(Cast F1,bVar"WT"),Mop(Cast F1,bVar"WB"),
           Mop(Cast F1,bVar"RA"),Mop(Cast F1,bVar"WA"),
           Var("NumSets",FTy 15),Var("Associativity",FTy 10),
           Var("LineSize",FTy 3)])]))
;
val write'rec'CCSIDR_def = Def
  ("write'rec'CCSIDR",TP[AVar F32,Var("x",CTy"CCSIDR")],
   Call("reg'CCSIDR",F32,Var("x",CTy"CCSIDR")))
;
val write'reg'CCSIDR_def = Def
  ("write'reg'CCSIDR",TP[AVar(CTy"CCSIDR"),Var("x",F32)],
   Call("rec'CCSIDR",CTy"CCSIDR",Var("x",F32)))
;
val rec'CSSELR_EL1_def = Def
  ("rec'CSSELR_EL1",Var("x",F32),
   Rec(CTy"CSSELR_EL1",
       [Bop(Bit,Var("x",F32),LN 0),EX(Var("x",F32),LN 3,LN 1,FTy 3),
        EX(Var("x",F32),LN 31,LN 4,FTy 28)]))
;
val reg'CSSELR_EL1_def = Def
  ("reg'CSSELR_EL1",Var("x",CTy"CSSELR_EL1"),
   CS(Var("x",CTy"CSSELR_EL1"),
      [(Rec(CTy"CSSELR_EL1",
            [bVar"InD",Var("Level",FTy 3),Var("RES0",FTy 28)]),
        CC[Var("RES0",FTy 28),Var("Level",FTy 3),Mop(Cast F1,bVar"InD")])]))
;
val write'rec'CSSELR_EL1_def = Def
  ("write'rec'CSSELR_EL1",TP[AVar F32,Var("x",CTy"CSSELR_EL1")],
   Call("reg'CSSELR_EL1",F32,Var("x",CTy"CSSELR_EL1")))
;
val write'reg'CSSELR_EL1_def = Def
  ("write'reg'CSSELR_EL1",TP[AVar(CTy"CSSELR_EL1"),Var("x",F32)],
   Call("rec'CSSELR_EL1",CTy"CSSELR_EL1",Var("x",F32)))
;
val rec'CTR_def = Def
  ("rec'CTR",Var("x",F32),
   Rec(CTy"CTR",
       [EX(Var("x",F32),LN 27,LN 24,F4),EX(Var("x",F32),LN 19,LN 16,F4),
        EX(Var("x",F32),LN 23,LN 20,F4),EX(Var("x",F32),LN 3,LN 0,F4),
        EX(Var("x",F32),LN 15,LN 14,FTy 2),
        EX(Var("x",F32),LN 30,LN 28,FTy 3),
        EX(Var("x",F32),LN 13,LN 4,FTy 10),Bop(Bit,Var("x",F32),LN 31)]))
;
val reg'CTR_def = Def
  ("reg'CTR",Var("x",CTy"CTR"),
   CS(Var("x",CTy"CTR"),
      [(Rec(CTy"CTR",
            [Var("CWG",F4),Var("DminLine",F4),Var("ERG",F4),
             Var("IminLine",F4),Var("L1Ip",FTy 2),Var("RES00",FTy 3),
             Var("RES01",FTy 10),bVar"RES1"]),
        CC[Mop(Cast F1,bVar"RES1"),Var("RES00",FTy 3),Var("CWG",F4),
           Var("ERG",F4),Var("DminLine",F4),Var("L1Ip",FTy 2),
           Var("RES01",FTy 10),Var("IminLine",F4)])]))
;
val write'rec'CTR_def = Def
  ("write'rec'CTR",TP[AVar F32,Var("x",CTy"CTR")],
   Call("reg'CTR",F32,Var("x",CTy"CTR")))
;
val write'reg'CTR_def = Def
  ("write'reg'CTR",TP[AVar(CTy"CTR"),Var("x",F32)],
   Call("rec'CTR",CTy"CTR",Var("x",F32)))
;
val EP_def = Def
  ("EP",
   TP[Var("h",LTy(PTy(CTy"actions",PTy(nTy,FTy 48)))),Var("t",FTy 48),
      Var("dc",ATy(FTy 48,CTy"CSET"))],LX(OTy(FTy 48)))
;
val read_mem_inner_def = Def
  ("read_mem_inner",
   TP[Var("size",BTy"N"),Var("ad",FTy 48),Var("pm",ATy(FTy 48,F8))],
   Mop(Fst,
       Mop(Snd,
           Mop(Snd,
               Apply
                 (For(TP[LN 0,
                         Bop(Sub,Bop(Div,Mop(Size,LY(0,"N")),LN 8),LN 1),
                         Close
                           (nVar"i",
                            Close
                              (Var("state",
                                   PTy(ATy(FTy 48,F8),PTy(vTy,uTy))),
                               TP[LU,
                                  Mop(Fst,
                                      Var("state",
                                          PTy(ATy(FTy 48,F8),PTy(vTy,uTy)))),
                                  CC[Mop(Cast vTy,
                                         Apply
                                           (Mop(Fst,
                                                Var("state",
                                                    PTy(ATy(FTy 48,F8),
                                                        PTy(vTy,uTy)))),
                                            Bop(Add,Var("ad",FTy 48),
                                                Mop(Cast(FTy 48),nVar"i")))),
                                     Mop(Fst,
                                         Mop(Snd,
                                             Var("state",
                                                 PTy(ATy(FTy 48,F8),
                                                     PTy(vTy,uTy)))))],LU]))]),
                  TP[Var("pm",ATy(FTy 48,F8)),LNL bTy,LU])))))
;
val read_mem32_def = Def
  ("read_mem32",TP[Var("ad",FTy 48),Var("pm",ATy(FTy 48,F8))],
   Mop(Cast vTy,
       CC[Apply
            (Var("pm",ATy(FTy 48,F8)),Bop(Add,Var("ad",FTy 48),LW(3,48))),
          Apply
            (Var("pm",ATy(FTy 48,F8)),Bop(Add,Var("ad",FTy 48),LW(2,48))),
          Apply
            (Var("pm",ATy(FTy 48,F8)),Bop(Add,Var("ad",FTy 48),LW(1,48))),
          Apply
            (Var("pm",ATy(FTy 48,F8)),Bop(Add,Var("ad",FTy 48),LW(0,48)))]))
;
val si_def = Def
  ("si",TP[Var("va",F64),Var("pa",FTy 48)],
   Close
     (qVar"state",
      Let(nVar"v0",
          Bop(Add,
              Mop(Cast nTy,
                  Dest
                    ("DminLine",F4,
                     Dest
                       ("ctr",CTy"CTR",
                        Dest("DC",CTy"CACHE_CONFIG",qVar"state")))),LN 1),
          Mop(Cast(FTy 48),
              EX(Mop(Cast vTy,Var("pa",FTy 48)),
                 Bop(Add,nVar"v0",
                     Mop(Cast nTy,
                         Mop(Log,
                             Bop(Add,
                                 Dest
                                   ("NumSets",FTy 15,
                                    Dest
                                      ("ccsidr",CTy"CCSIDR",
                                       Dest
                                         ("DC",CTy"CACHE_CONFIG",
                                          qVar"state"))),LW(1,15))))),
                 Bop(Add,nVar"v0",LN 1),vTy)))))
;
val tag_def = Def
  ("tag",TP[Var("va",F64),Var("pa",FTy 48)],
   Close
     (qVar"state",
      Mop(Cast(FTy 48),
          EX(Mop(Cast vTy,Var("pa",FTy 48)),
             Bop(Sub,Mop(Length,Mop(Cast vTy,Var("pa",FTy 48))),LN 1),
             Bop(Add,
                 Bop(Add,
                     Bop(Add,
                         Mop(Cast nTy,
                             Dest
                               ("DminLine",F4,
                                Dest
                                  ("ctr",CTy"CTR",
                                   Dest
                                     ("DC",CTy"CACHE_CONFIG",qVar"state")))),
                         LN 1),
                     Mop(Cast nTy,
                         Mop(Log,
                             Bop(Add,
                                 Dest
                                   ("NumSets",FTy 15,
                                    Dest
                                      ("ccsidr",CTy"CCSIDR",
                                       Dest
                                         ("DC",CTy"CACHE_CONFIG",
                                          qVar"state"))),LW(1,15))))),LN 1),
             vTy))))
;
val wIdx_def = Def
  ("wIdx",Var("pa",FTy 48),
   Close
     (qVar"state",
      Mop(Cast(FTy 48),
          EX(Mop(Cast vTy,Var("pa",FTy 48)),
             Bop(Add,
                 Mop(Cast nTy,
                     Dest
                       ("DminLine",F4,
                        Dest
                          ("ctr",CTy"CTR",
                           Dest("DC",CTy"CACHE_CONFIG",qVar"state")))),
                 LN 1),LN 2,vTy))))
;
val lineSpec_def = Def
  ("lineSpec",TP[Var("va",F64),Var("pa",FTy 48)],
   Close
     (qVar"state",
      TP[Apply
           (Call("si",ATy(qTy,FTy 48),TP[Var("va",F64),Var("pa",FTy 48)]),
            qVar"state"),
         Apply
           (Call("tag",ATy(qTy,FTy 48),TP[Var("va",F64),Var("pa",FTy 48)]),
            qVar"state"),
         Mop(Cast nTy,
             Apply
               (Call("wIdx",ATy(qTy,FTy 48),Var("pa",FTy 48)),qVar"state"))]))
;
val WriteBack_def = Def
  ("WriteBack",
   TP[Var("i",FTy 48),Var("t",FTy 48),nVar"wi",Var("pm",ATy(FTy 48,F8)),
      Var("cslCnt",CTy"SLVAL")],
   Close
     (qVar"state",
      Let(Var("s0",F32),
          Apply
            (Dest("value",ATy(FTy 48,F32),Var("cslCnt",CTy"SLVAL")),
             Mop(Cast(FTy 48),nVar"wi")),
          Let(nVar"v",
              Mop(Cast nTy,
                  Dest
                    ("DminLine",F4,
                     Dest
                       ("ctr",CTy"CTR",
                        Dest("DC",CTy"CACHE_CONFIG",qVar"state")))),
              Let(Var("pa",FTy 48),
                  Bop(BOr,
                      Bop(BOr,
                          Bop(Lsl,Var("t",FTy 48),
                              Bop(Add,
                                  Bop(Add,
                                      Mop(Cast nTy,
                                          Mop(Log,
                                              Bop(Add,
                                                  Dest
                                                    ("NumSets",FTy 15,
                                                     Dest
                                                       ("ccsidr",
                                                        CTy"CCSIDR",
                                                        Dest
                                                          ("DC",
                                                           CTy"CACHE_CONFIG",
                                                           qVar"state"))),
                                                  LW(1,15)))),nVar"v"),
                                  LN 2)),
                          Bop(Lsl,Var("i",FTy 48),Bop(Add,nVar"v",LN 2))),
                      Bop(Lsl,Mop(Cast(FTy 48),nVar"wi"),LN 2)),
                  Fupd
                    (Fupd
                       (Fupd
                          (Fupd
                             (Var("pm",ATy(FTy 48,F8)),Var("pa",FTy 48),
                              EX(Var("s0",F32),LN 7,LN 0,F8)),
                           Bop(Add,Var("pa",FTy 48),LW(1,48)),
                           EX(Var("s0",F32),LN 15,LN 8,F8)),
                        Bop(Add,Var("pa",FTy 48),LW(2,48)),
                        EX(Var("s0",F32),LN 23,LN 16,F8)),
                     Bop(Add,Var("pa",FTy 48),LW(3,48)),
                     EX(Var("s0",F32),LN 31,LN 24,F8)))))))
;
val WriteBackLine_def = Def
  ("WriteBackLine",
   TP[Var("li",FTy 48),Var("t",FTy 48),Var("pm",ATy(FTy 48,F8)),
      Var("dc",ATy(FTy 48,CTy"CSET")),nVar"n"],
   Close
     (qVar"state",
      Let(Var("v",ATy(FTy 48,OTy(CTy"SLVAL"))),
          Dest
            ("sl",ATy(FTy 48,OTy(CTy"SLVAL")),
             Apply(Var("dc",ATy(FTy 48,CTy"CSET")),Var("li",FTy 48))),
          Let(Var("s5",CTy"SLVAL"),
              Mop(ValOf,
                  Apply
                    (Var("v",ATy(FTy 48,OTy(CTy"SLVAL"))),Var("t",FTy 48))),
              Let(nVar"v0",
                  Mop(Cast nTy,
                      Dest
                        ("DminLine",F4,
                         Dest
                           ("ctr",CTy"CTR",
                            Dest("DC",CTy"CACHE_CONFIG",qVar"state")))),
                  Let(Var("s",
                          PTy(CTy"SLVAL",
                              PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                                  PTy(ATy(FTy 48,CTy"CSET"),
                                      PTy(ATy(FTy 48,F8),qTy))))),
                      ITE(Dest("dirty",bTy,Var("s5",CTy"SLVAL")),
                          Mop(Snd,
                              Apply
                                (For(TP[LN 0,nVar"n",
                                        Close
                                          (nVar"i",
                                           Close
                                             (Var("state0",
                                                  PTy(CTy"SLVAL",
                                                      PTy(ATy(FTy 48,
                                                              OTy(CTy"SLVAL")),
                                                          PTy(ATy(FTy 48,
                                                                  CTy"CSET"),
                                                              PTy(ATy(FTy 48,
                                                                      F8),
                                                                  qTy))))),
                                              Let(Var("v1",F32),
                                                  Apply
                                                    (Dest
                                                       ("value",
                                                        ATy(FTy 48,F32),
                                                        Mop(Fst,
                                                            Var("state0",
                                                                PTy(CTy"SLVAL",
                                                                    PTy(ATy(FTy 48,
                                                                            OTy(CTy"SLVAL")),
                                                                        PTy(ATy(FTy 48,
                                                                                CTy"CSET"),
                                                                            PTy(ATy(FTy 48,
                                                                                    F8),
                                                                                qTy))))))),
                                                     Mop(Cast(FTy 48),
                                                         nVar"i")),
                                                  Let(Var("pa",FTy 48),
                                                      Bop(BOr,
                                                          Bop(BOr,
                                                              Bop(Lsl,
                                                                  Var("t",
                                                                      FTy 48),
                                                                  Bop(Add,
                                                                      Bop(Add,
                                                                          Mop(Cast
                                                                                nTy,
                                                                              Mop(Log,
                                                                                  Bop(Add,
                                                                                      Dest
                                                                                        ("NumSets",
                                                                                         FTy 15,
                                                                                         Dest
                                                                                           ("ccsidr",
                                                                                            CTy"CCSIDR",
                                                                                            Dest
                                                                                              ("DC",
                                                                                               CTy"CACHE_CONFIG",
                                                                                               qVar"state"))),
                                                                                      LW(1,
                                                                                         15)))),
                                                                          nVar"v0"),
                                                                      LN 2)),
                                                              Bop(Lsl,
                                                                  Var("li",
                                                                      FTy 48),
                                                                  Bop(Add,
                                                                      nVar"v0",
                                                                      LN 2))),
                                                          Bop(Lsl,
                                                              Mop(Cast
                                                                    (FTy 48),
                                                                  nVar"i"),
                                                              LN 2)),
                                                      Let(Var("s",
                                                              PTy(CTy"SLVAL",
                                                                  PTy(ATy(FTy 48,
                                                                          OTy(CTy"SLVAL")),
                                                                      PTy(ATy(FTy 48,
                                                                              CTy"CSET"),
                                                                          PTy(ATy(FTy 48,
                                                                                  F8),
                                                                              qTy))))),
                                                          TP[Mop(Fst,
                                                                 Var("state0",
                                                                     PTy(CTy"SLVAL",
                                                                         PTy(ATy(FTy 48,
                                                                                 OTy(CTy"SLVAL")),
                                                                             PTy(ATy(FTy 48,
                                                                                     CTy"CSET"),
                                                                                 PTy(ATy(FTy 48,
                                                                                         F8),
                                                                                     qTy)))))),
                                                             Let(Var("s0",
                                                                     PTy(ATy(FTy 48,
                                                                             OTy(CTy"SLVAL")),
                                                                         PTy(ATy(FTy 48,
                                                                                 CTy"CSET"),
                                                                             PTy(ATy(FTy 48,
                                                                                     F8),
                                                                                 qTy)))),
                                                                 Mop(Snd,
                                                                     Var("state0",
                                                                         PTy(CTy"SLVAL",
                                                                             PTy(ATy(FTy 48,
                                                                                     OTy(CTy"SLVAL")),
                                                                                 PTy(ATy(FTy 48,
                                                                                         CTy"CSET"),
                                                                                     PTy(ATy(FTy 48,
                                                                                             F8),
                                                                                         qTy)))))),
                                                                 TP[Mop(Fst,
                                                                        Var("s0",
                                                                            PTy(ATy(FTy 48,
                                                                                    OTy(CTy"SLVAL")),
                                                                                PTy(ATy(FTy 48,
                                                                                        CTy"CSET"),
                                                                                    PTy(ATy(FTy 48,
                                                                                            F8),
                                                                                        qTy))))),
                                                                    Let(Var("s0",
                                                                            PTy(ATy(FTy 48,
                                                                                    CTy"CSET"),
                                                                                PTy(ATy(FTy 48,
                                                                                        F8),
                                                                                    qTy))),
                                                                        Mop(Snd,
                                                                            Var("s0",
                                                                                PTy(ATy(FTy 48,
                                                                                        OTy(CTy"SLVAL")),
                                                                                    PTy(ATy(FTy 48,
                                                                                            CTy"CSET"),
                                                                                        PTy(ATy(FTy 48,
                                                                                                F8),
                                                                                            qTy))))),
                                                                        TP[Mop(Fst,
                                                                               Var("s0",
                                                                                   PTy(ATy(FTy 48,
                                                                                           CTy"CSET"),
                                                                                       PTy(ATy(FTy 48,
                                                                                               F8),
                                                                                           qTy)))),
                                                                           Fupd
                                                                             (Mop(Fst,
                                                                                  Mop(Snd,
                                                                                      Mop(Snd,
                                                                                          Mop(Snd,
                                                                                              Var("state0",
                                                                                                  PTy(CTy"SLVAL",
                                                                                                      PTy(ATy(FTy 48,
                                                                                                              OTy(CTy"SLVAL")),
                                                                                                          PTy(ATy(FTy 48,
                                                                                                                  CTy"CSET"),
                                                                                                              PTy(ATy(FTy 48,
                                                                                                                      F8),
                                                                                                                  qTy))))))))),
                                                                              Var("pa",
                                                                                  FTy 48),
                                                                              EX(Var("v1",
                                                                                     F32),
                                                                                 LN
                                                                                  7,
                                                                                 LN
                                                                                  0,
                                                                                 F8)),
                                                                           Mop(Snd,
                                                                               Mop(Snd,
                                                                                   Var("s0",
                                                                                       PTy(ATy(FTy 48,
                                                                                               CTy"CSET"),
                                                                                           PTy(ATy(FTy 48,
                                                                                                   F8),
                                                                                               qTy)))))])])],
                                                          Let(Var("s",
                                                                  PTy(CTy"SLVAL",
                                                                      PTy(ATy(FTy 48,
                                                                              OTy(CTy"SLVAL")),
                                                                          PTy(ATy(FTy 48,
                                                                                  CTy"CSET"),
                                                                              PTy(ATy(FTy 48,
                                                                                      F8),
                                                                                  qTy))))),
                                                              TP[Mop(Fst,
                                                                     Var("s",
                                                                         PTy(CTy"SLVAL",
                                                                             PTy(ATy(FTy 48,
                                                                                     OTy(CTy"SLVAL")),
                                                                                 PTy(ATy(FTy 48,
                                                                                         CTy"CSET"),
                                                                                     PTy(ATy(FTy 48,
                                                                                             F8),
                                                                                         qTy)))))),
                                                                 Let(Var("s0",
                                                                         PTy(ATy(FTy 48,
                                                                                 OTy(CTy"SLVAL")),
                                                                             PTy(ATy(FTy 48,
                                                                                     CTy"CSET"),
                                                                                 PTy(ATy(FTy 48,
                                                                                         F8),
                                                                                     qTy)))),
                                                                     Mop(Snd,
                                                                         Var("s",
                                                                             PTy(CTy"SLVAL",
                                                                                 PTy(ATy(FTy 48,
                                                                                         OTy(CTy"SLVAL")),
                                                                                     PTy(ATy(FTy 48,
                                                                                             CTy"CSET"),
                                                                                         PTy(ATy(FTy 48,
                                                                                                 F8),
                                                                                             qTy)))))),
                                                                     TP[Mop(Fst,
                                                                            Var("s0",
                                                                                PTy(ATy(FTy 48,
                                                                                        OTy(CTy"SLVAL")),
                                                                                    PTy(ATy(FTy 48,
                                                                                            CTy"CSET"),
                                                                                        PTy(ATy(FTy 48,
                                                                                                F8),
                                                                                            qTy))))),
                                                                        Let(Var("s0",
                                                                                PTy(ATy(FTy 48,
                                                                                        CTy"CSET"),
                                                                                    PTy(ATy(FTy 48,
                                                                                            F8),
                                                                                        qTy))),
                                                                            Mop(Snd,
                                                                                Var("s0",
                                                                                    PTy(ATy(FTy 48,
                                                                                            OTy(CTy"SLVAL")),
                                                                                        PTy(ATy(FTy 48,
                                                                                                CTy"CSET"),
                                                                                            PTy(ATy(FTy 48,
                                                                                                    F8),
                                                                                                qTy))))),
                                                                            TP[Mop(Fst,
                                                                                   Var("s0",
                                                                                       PTy(ATy(FTy 48,
                                                                                               CTy"CSET"),
                                                                                           PTy(ATy(FTy 48,
                                                                                                   F8),
                                                                                               qTy)))),
                                                                               Fupd
                                                                                 (Mop(Fst,
                                                                                      Mop(Snd,
                                                                                          Mop(Snd,
                                                                                              Mop(Snd,
                                                                                                  Var("s",
                                                                                                      PTy(CTy"SLVAL",
                                                                                                          PTy(ATy(FTy 48,
                                                                                                                  OTy(CTy"SLVAL")),
                                                                                                              PTy(ATy(FTy 48,
                                                                                                                      CTy"CSET"),
                                                                                                                  PTy(ATy(FTy 48,
                                                                                                                          F8),
                                                                                                                      qTy))))))))),
                                                                                  Bop(Add,
                                                                                      Var("pa",
                                                                                          FTy 48),
                                                                                      LW(1,
                                                                                         48)),
                                                                                  EX(Var("v1",
                                                                                         F32),
                                                                                     LN
                                                                                      15,
                                                                                     LN
                                                                                      8,
                                                                                     F8)),
                                                                               Mop(Snd,
                                                                                   Mop(Snd,
                                                                                       Var("s0",
                                                                                           PTy(ATy(FTy 48,
                                                                                                   CTy"CSET"),
                                                                                               PTy(ATy(FTy 48,
                                                                                                       F8),
                                                                                                   qTy)))))])])],
                                                              Let(Var("s",
                                                                      PTy(CTy"SLVAL",
                                                                          PTy(ATy(FTy 48,
                                                                                  OTy(CTy"SLVAL")),
                                                                              PTy(ATy(FTy 48,
                                                                                      CTy"CSET"),
                                                                                  PTy(ATy(FTy 48,
                                                                                          F8),
                                                                                      qTy))))),
                                                                  TP[Mop(Fst,
                                                                         Var("s",
                                                                             PTy(CTy"SLVAL",
                                                                                 PTy(ATy(FTy 48,
                                                                                         OTy(CTy"SLVAL")),
                                                                                     PTy(ATy(FTy 48,
                                                                                             CTy"CSET"),
                                                                                         PTy(ATy(FTy 48,
                                                                                                 F8),
                                                                                             qTy)))))),
                                                                     Let(Var("s0",
                                                                             PTy(ATy(FTy 48,
                                                                                     OTy(CTy"SLVAL")),
                                                                                 PTy(ATy(FTy 48,
                                                                                         CTy"CSET"),
                                                                                     PTy(ATy(FTy 48,
                                                                                             F8),
                                                                                         qTy)))),
                                                                         Mop(Snd,
                                                                             Var("s",
                                                                                 PTy(CTy"SLVAL",
                                                                                     PTy(ATy(FTy 48,
                                                                                             OTy(CTy"SLVAL")),
                                                                                         PTy(ATy(FTy 48,
                                                                                                 CTy"CSET"),
                                                                                             PTy(ATy(FTy 48,
                                                                                                     F8),
                                                                                                 qTy)))))),
                                                                         TP[Mop(Fst,
                                                                                Var("s0",
                                                                                    PTy(ATy(FTy 48,
                                                                                            OTy(CTy"SLVAL")),
                                                                                        PTy(ATy(FTy 48,
                                                                                                CTy"CSET"),
                                                                                            PTy(ATy(FTy 48,
                                                                                                    F8),
                                                                                                qTy))))),
                                                                            Let(Var("s0",
                                                                                    PTy(ATy(FTy 48,
                                                                                            CTy"CSET"),
                                                                                        PTy(ATy(FTy 48,
                                                                                                F8),
                                                                                            qTy))),
                                                                                Mop(Snd,
                                                                                    Var("s0",
                                                                                        PTy(ATy(FTy 48,
                                                                                                OTy(CTy"SLVAL")),
                                                                                            PTy(ATy(FTy 48,
                                                                                                    CTy"CSET"),
                                                                                                PTy(ATy(FTy 48,
                                                                                                        F8),
                                                                                                    qTy))))),
                                                                                TP[Mop(Fst,
                                                                                       Var("s0",
                                                                                           PTy(ATy(FTy 48,
                                                                                                   CTy"CSET"),
                                                                                               PTy(ATy(FTy 48,
                                                                                                       F8),
                                                                                                   qTy)))),
                                                                                   Fupd
                                                                                     (Mop(Fst,
                                                                                          Mop(Snd,
                                                                                              Mop(Snd,
                                                                                                  Mop(Snd,
                                                                                                      Var("s",
                                                                                                          PTy(CTy"SLVAL",
                                                                                                              PTy(ATy(FTy 48,
                                                                                                                      OTy(CTy"SLVAL")),
                                                                                                                  PTy(ATy(FTy 48,
                                                                                                                          CTy"CSET"),
                                                                                                                      PTy(ATy(FTy 48,
                                                                                                                              F8),
                                                                                                                          qTy))))))))),
                                                                                      Bop(Add,
                                                                                          Var("pa",
                                                                                              FTy 48),
                                                                                          LW(2,
                                                                                             48)),
                                                                                      EX(Var("v1",
                                                                                             F32),
                                                                                         LN
                                                                                          23,
                                                                                         LN
                                                                                          16,
                                                                                         F8)),
                                                                                   Mop(Snd,
                                                                                       Mop(Snd,
                                                                                           Var("s0",
                                                                                               PTy(ATy(FTy 48,
                                                                                                       CTy"CSET"),
                                                                                                   PTy(ATy(FTy 48,
                                                                                                           F8),
                                                                                                       qTy)))))])])],
                                                                  TP[LU,
                                                                     Mop(Fst,
                                                                         Var("s",
                                                                             PTy(CTy"SLVAL",
                                                                                 PTy(ATy(FTy 48,
                                                                                         OTy(CTy"SLVAL")),
                                                                                     PTy(ATy(FTy 48,
                                                                                             CTy"CSET"),
                                                                                         PTy(ATy(FTy 48,
                                                                                                 F8),
                                                                                             qTy)))))),
                                                                     Let(Var("s0",
                                                                             PTy(ATy(FTy 48,
                                                                                     OTy(CTy"SLVAL")),
                                                                                 PTy(ATy(FTy 48,
                                                                                         CTy"CSET"),
                                                                                     PTy(ATy(FTy 48,
                                                                                             F8),
                                                                                         qTy)))),
                                                                         Mop(Snd,
                                                                             Var("s",
                                                                                 PTy(CTy"SLVAL",
                                                                                     PTy(ATy(FTy 48,
                                                                                             OTy(CTy"SLVAL")),
                                                                                         PTy(ATy(FTy 48,
                                                                                                 CTy"CSET"),
                                                                                             PTy(ATy(FTy 48,
                                                                                                     F8),
                                                                                                 qTy)))))),
                                                                         TP[Mop(Fst,
                                                                                Var("s0",
                                                                                    PTy(ATy(FTy 48,
                                                                                            OTy(CTy"SLVAL")),
                                                                                        PTy(ATy(FTy 48,
                                                                                                CTy"CSET"),
                                                                                            PTy(ATy(FTy 48,
                                                                                                    F8),
                                                                                                qTy))))),
                                                                            Let(Var("s0",
                                                                                    PTy(ATy(FTy 48,
                                                                                            CTy"CSET"),
                                                                                        PTy(ATy(FTy 48,
                                                                                                F8),
                                                                                            qTy))),
                                                                                Mop(Snd,
                                                                                    Var("s0",
                                                                                        PTy(ATy(FTy 48,
                                                                                                OTy(CTy"SLVAL")),
                                                                                            PTy(ATy(FTy 48,
                                                                                                    CTy"CSET"),
                                                                                                PTy(ATy(FTy 48,
                                                                                                        F8),
                                                                                                    qTy))))),
                                                                                TP[Mop(Fst,
                                                                                       Var("s0",
                                                                                           PTy(ATy(FTy 48,
                                                                                                   CTy"CSET"),
                                                                                               PTy(ATy(FTy 48,
                                                                                                       F8),
                                                                                                   qTy)))),
                                                                                   Fupd
                                                                                     (Mop(Fst,
                                                                                          Mop(Snd,
                                                                                              Mop(Snd,
                                                                                                  Mop(Snd,
                                                                                                      Var("s",
                                                                                                          PTy(CTy"SLVAL",
                                                                                                              PTy(ATy(FTy 48,
                                                                                                                      OTy(CTy"SLVAL")),
                                                                                                                  PTy(ATy(FTy 48,
                                                                                                                          CTy"CSET"),
                                                                                                                      PTy(ATy(FTy 48,
                                                                                                                              F8),
                                                                                                                          qTy))))))))),
                                                                                      Bop(Add,
                                                                                          Var("pa",
                                                                                              FTy 48),
                                                                                          LW(3,
                                                                                             48)),
                                                                                      EX(Var("v1",
                                                                                             F32),
                                                                                         LN
                                                                                          31,
                                                                                         LN
                                                                                          24,
                                                                                         F8)),
                                                                                   Mop(Snd,
                                                                                       Mop(Snd,
                                                                                           Var("s0",
                                                                                               PTy(ATy(FTy 48,
                                                                                                       CTy"CSET"),
                                                                                                   PTy(ATy(FTy 48,
                                                                                                           F8),
                                                                                                       qTy)))))])])])))))))]),
                                 TP[Var("s5",CTy"SLVAL"),
                                    Var("v",ATy(FTy 48,OTy(CTy"SLVAL"))),
                                    Var("dc",ATy(FTy 48,CTy"CSET")),
                                    Var("pm",ATy(FTy 48,F8)),qVar"state"])),
                          TP[Var("s5",CTy"SLVAL"),
                             Var("v",ATy(FTy 48,OTy(CTy"SLVAL"))),
                             Var("dc",ATy(FTy 48,CTy"CSET")),
                             Var("pm",ATy(FTy 48,F8)),qVar"state"]),
                      Let(Var("s",
                              PTy(CTy"SLVAL",
                                  PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                                      PTy(ATy(FTy 48,CTy"CSET"),
                                          PTy(ATy(FTy 48,F8),qTy))))),
                          TP[Rupd
                               ("dirty",
                                TP[Mop(Fst,
                                       Var("s",
                                           PTy(CTy"SLVAL",
                                               PTy(ATy(FTy 48,
                                                       OTy(CTy"SLVAL")),
                                                   PTy(ATy(FTy 48,
                                                           CTy"CSET"),
                                                       PTy(ATy(FTy 48,F8),
                                                           qTy)))))),LF]),
                             Mop(Snd,
                                 Var("s",
                                     PTy(CTy"SLVAL",
                                         PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                                             PTy(ATy(FTy 48,CTy"CSET"),
                                                 PTy(ATy(FTy 48,F8),qTy))))))],
                          Let(Var("s",
                                  PTy(CTy"SLVAL",
                                      PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                                          PTy(ATy(FTy 48,CTy"CSET"),
                                              PTy(ATy(FTy 48,F8),qTy))))),
                              TP[Mop(Fst,
                                     Var("s",
                                         PTy(CTy"SLVAL",
                                             PTy(ATy(FTy 48,
                                                     OTy(CTy"SLVAL")),
                                                 PTy(ATy(FTy 48,CTy"CSET"),
                                                     PTy(ATy(FTy 48,F8),
                                                         qTy)))))),
                                 Fupd
                                   (Mop(Fst,
                                        Mop(Snd,
                                            Var("s",
                                                PTy(CTy"SLVAL",
                                                    PTy(ATy(FTy 48,
                                                            OTy(CTy"SLVAL")),
                                                        PTy(ATy(FTy 48,
                                                                CTy"CSET"),
                                                            PTy(ATy(FTy 48,
                                                                    F8),
                                                                qTy))))))),
                                    Var("t",FTy 48),
                                    Mop(Some,
                                        Mop(Fst,
                                            Var("s",
                                                PTy(CTy"SLVAL",
                                                    PTy(ATy(FTy 48,
                                                            OTy(CTy"SLVAL")),
                                                        PTy(ATy(FTy 48,
                                                                CTy"CSET"),
                                                            PTy(ATy(FTy 48,
                                                                    F8),
                                                                qTy)))))))),
                                 Mop(Snd,
                                     Mop(Snd,
                                         Var("s",
                                             PTy(CTy"SLVAL",
                                                 PTy(ATy(FTy 48,
                                                         OTy(CTy"SLVAL")),
                                                     PTy(ATy(FTy 48,
                                                             CTy"CSET"),
                                                         PTy(ATy(FTy 48,F8),
                                                             qTy)))))))],
                              Let(Var("s",
                                      PTy(CTy"SLVAL",
                                          PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                                              PTy(ATy(FTy 48,CTy"CSET"),
                                                  PTy(ATy(FTy 48,F8),qTy))))),
                                  TP[Mop(Fst,
                                         Var("s",
                                             PTy(CTy"SLVAL",
                                                 PTy(ATy(FTy 48,
                                                         OTy(CTy"SLVAL")),
                                                     PTy(ATy(FTy 48,
                                                             CTy"CSET"),
                                                         PTy(ATy(FTy 48,F8),
                                                             qTy)))))),
                                     Let(Var("s0",
                                             PTy(ATy(FTy 48,
                                                     OTy(CTy"SLVAL")),
                                                 PTy(ATy(FTy 48,CTy"CSET"),
                                                     PTy(ATy(FTy 48,F8),
                                                         qTy)))),
                                         Mop(Snd,
                                             Var("s",
                                                 PTy(CTy"SLVAL",
                                                     PTy(ATy(FTy 48,
                                                             OTy(CTy"SLVAL")),
                                                         PTy(ATy(FTy 48,
                                                                 CTy"CSET"),
                                                             PTy(ATy(FTy 48,
                                                                     F8),
                                                                 qTy)))))),
                                         TP[Mop(Fst,
                                                Var("s0",
                                                    PTy(ATy(FTy 48,
                                                            OTy(CTy"SLVAL")),
                                                        PTy(ATy(FTy 48,
                                                                CTy"CSET"),
                                                            PTy(ATy(FTy 48,
                                                                    F8),
                                                                qTy))))),
                                            Fupd
                                              (Mop(Fst,
                                                   Mop(Snd,
                                                       Mop(Snd,
                                                           Var("s",
                                                               PTy(CTy"SLVAL",
                                                                   PTy(ATy(FTy 48,
                                                                           OTy(CTy"SLVAL")),
                                                                       PTy(ATy(FTy 48,
                                                                               CTy"CSET"),
                                                                           PTy(ATy(FTy 48,
                                                                                   F8),
                                                                               qTy)))))))),
                                               Var("li",FTy 48),
                                               Rupd
                                                 ("sl",
                                                  TP[Apply
                                                       (Mop(Fst,
                                                            Mop(Snd,
                                                                Mop(Snd,
                                                                    Var("s",
                                                                        PTy(CTy"SLVAL",
                                                                            PTy(ATy(FTy 48,
                                                                                    OTy(CTy"SLVAL")),
                                                                                PTy(ATy(FTy 48,
                                                                                        CTy"CSET"),
                                                                                    PTy(ATy(FTy 48,
                                                                                            F8),
                                                                                        qTy)))))))),
                                                        Var("li",FTy 48)),
                                                     Mop(Fst,
                                                         Mop(Snd,
                                                             Var("s",
                                                                 PTy(CTy"SLVAL",
                                                                     PTy(ATy(FTy 48,
                                                                             OTy(CTy"SLVAL")),
                                                                         PTy(ATy(FTy 48,
                                                                                 CTy"CSET"),
                                                                             PTy(ATy(FTy 48,
                                                                                     F8),
                                                                                 qTy)))))))])),
                                            Mop(Snd,
                                                Mop(Snd,
                                                    Var("s0",
                                                        PTy(ATy(FTy 48,
                                                                OTy(CTy"SLVAL")),
                                                            PTy(ATy(FTy 48,
                                                                    CTy"CSET"),
                                                                PTy(ATy(FTy 48,
                                                                        F8),
                                                                    qTy))))))])],
                                  TP[Mop(Fst,
                                         Mop(Snd,
                                             Mop(Snd,
                                                 Var("s",
                                                     PTy(CTy"SLVAL",
                                                         PTy(ATy(FTy 48,
                                                                 OTy(CTy"SLVAL")),
                                                             PTy(ATy(FTy 48,
                                                                     CTy"CSET"),
                                                                 PTy(ATy(FTy 48,
                                                                         F8),
                                                                     qTy)))))))),
                                     Mop(Fst,
                                         Mop(Snd,
                                             Mop(Snd,
                                                 Mop(Snd,
                                                     Var("s",
                                                         PTy(CTy"SLVAL",
                                                             PTy(ATy(FTy 48,
                                                                     OTy(CTy"SLVAL")),
                                                                 PTy(ATy(FTy 48,
                                                                         CTy"CSET"),
                                                                     PTy(ATy(FTy 48,
                                                                             F8),
                                                                         qTy)))))))))])))))))))
;
val Alias_def = Def
  ("Alias",
   TP[Var("va",F64),Var("pa",FTy 48),Var("dc",ATy(FTy 48,CTy"CSET"))],
   Close
     (qVar"state",
      Let(TP[AVar(FTy 48),Var("t",FTy 48),AVar nTy],
          Apply
            (Call
               ("lineSpec",ATy(qTy,PTy(FTy 48,PTy(FTy 48,nTy))),
                TP[Var("va",F64),Var("pa",FTy 48)]),qVar"state"),
          Mop(Fst,
              Mop(Snd,
                  Apply
                    (For(TP[LN 0,
                            Bop(Sub,
                                Bop(Mul,
                                    Bop(Add,
                                        Mop(Cast nTy,
                                            Dest
                                              ("NumSets",FTy 15,
                                               Dest
                                                 ("ccsidr",CTy"CCSIDR",
                                                  Dest
                                                    ("DC",
                                                     CTy"CACHE_CONFIG",
                                                     qVar"state")))),LN 1),
                                    Bop(Add,
                                        Mop(Cast nTy,
                                            Dest
                                              ("Associativity",FTy 10,
                                               Dest
                                                 ("ccsidr",CTy"CCSIDR",
                                                  Dest
                                                    ("DC",
                                                     CTy"CACHE_CONFIG",
                                                     qVar"state")))),LN 1)),
                                LN 1),
                            Close
                              (nVar"i",
                               Close
                                 (Var("state",
                                      PTy(OTy(FTy 48),
                                          PTy(ATy(FTy 48,CTy"CSET"),qTy))),
                                  TP[LU,
                                     ITE(Mop(IsSome,
                                             Apply
                                               (Dest
                                                  ("sl",
                                                   ATy(FTy 48,
                                                       OTy(CTy"SLVAL")),
                                                   Apply
                                                     (Mop(Fst,
                                                          Mop(Snd,
                                                              Var("state",
                                                                  PTy(OTy(FTy 48),
                                                                      PTy(ATy(FTy 48,
                                                                              CTy"CSET"),
                                                                          qTy))))),
                                                      Mop(Cast(FTy 48),
                                                          nVar"i"))),
                                                Var("t",FTy 48))),
                                         TP[Mop(Some,
                                                Mop(Cast(FTy 48),nVar"i")),
                                            Mop(Snd,
                                                Var("state",
                                                    PTy(OTy(FTy 48),
                                                        PTy(ATy(FTy 48,
                                                                CTy"CSET"),
                                                            qTy))))],
                                         Var("state",
                                             PTy(OTy(FTy 48),
                                                 PTy(ATy(FTy 48,CTy"CSET"),
                                                     qTy))))]))]),
                     TP[LX(OTy(FTy 48)),Var("dc",ATy(FTy 48,CTy"CSET")),
                        qVar"state"]))))))
;
val Touch_def = Def
  ("Touch",
   TP[Var("h",LTy(PTy(CTy"actions",PTy(nTy,FTy 48)))),Var("li",FTy 48),
      Var("t",FTy 48),Var("wi",FTy 48),Var("data",OTy(CTy"wrTyp")),
      Var("dc",ATy(FTy 48,CTy"CSET"))],
   Let(Var("v",ATy(FTy 48,OTy(CTy"SLVAL"))),
       Dest
         ("sl",ATy(FTy 48,OTy(CTy"SLVAL")),
          Apply(Var("dc",ATy(FTy 48,CTy"CSET")),Var("li",FTy 48))),
       Let(Var("v0",CTy"SLVAL"),
           Mop(ValOf,
               Apply(Var("v",ATy(FTy 48,OTy(CTy"SLVAL"))),Var("t",FTy 48))),
           ITE(Mop(IsSome,Var("data",OTy(CTy"wrTyp"))),
               Let(Var("data",CTy"wrTyp"),
                   Mop(ValOf,Var("data",OTy(CTy"wrTyp"))),
                   TP[Fupd
                        (Var("v",ATy(FTy 48,OTy(CTy"SLVAL"))),
                         Var("t",FTy 48),
                         Mop(Some,
                             Rupd
                               ("value",
                                TP[Rupd
                                     ("dirty",
                                      TP[Var("v0",CTy"SLVAL"),
                                         Dest
                                           ("flag",bTy,
                                            Var("data",CTy"wrTyp"))]),
                                   Fupd
                                     (Dest
                                        ("value",ATy(FTy 48,F32),
                                         Var("v0",CTy"SLVAL")),
                                      Var("wi",FTy 48),
                                      Dest
                                        ("value",F32,
                                         Var("data",CTy"wrTyp")))]))),
                      LLC([TP[LC("a_write",CTy"actions"),
                              Mop(Cast nTy,Var("t",FTy 48)),
                              Var("li",FTy 48)]],
                          Var("h",LTy(PTy(CTy"actions",PTy(nTy,FTy 48)))))]),
               TP[Dest
                    ("sl",ATy(FTy 48,OTy(CTy"SLVAL")),
                     Apply
                       (Var("dc",ATy(FTy 48,CTy"CSET")),Var("li",FTy 48))),
                  LLC([TP[LC("a_read",CTy"actions"),
                          Mop(Cast nTy,Var("t",FTy 48)),Var("li",FTy 48)]],
                      Var("h",LTy(PTy(CTy"actions",PTy(nTy,FTy 48)))))]))))
;
val Evict_def = Def
  ("Evict",
   TP[Var("h",LTy(PTy(CTy"actions",PTy(nTy,FTy 48)))),Var("li",FTy 48),
      Var("t",FTy 48),Var("dc",ATy(FTy 48,CTy"CSET"))],
   TP[Fupd
        (Dest
           ("sl",ATy(FTy 48,OTy(CTy"SLVAL")),
            Apply(Var("dc",ATy(FTy 48,CTy"CSET")),Var("li",FTy 48))),
         Var("t",FTy 48),LO(CTy"SLVAL")),
      LLC([TP[LC("a_evict",CTy"actions"),Mop(Cast nTy,Var("t",FTy 48)),
              Var("li",FTy 48)]],
          Var("h",LTy(PTy(CTy"actions",PTy(nTy,FTy 48)))))])
;
val CellFill_def = Def
  ("CellFill",TP[nVar"wi",Var("adr",FTy 48),Var("pm",ATy(FTy 48,F8))],
   Fupd
     (LX(ATy(FTy 48,F32)),Mop(Cast(FTy 48),nVar"wi"),
      Mop(Cast F32,
          Call
            ("read_mem32",vTy,
             TP[Bop(BOr,Var("adr",FTy 48),
                    Bop(Lsl,Mop(Cast(FTy 48),nVar"wi"),LN 2)),
                Var("pm",ATy(FTy 48,F8))]))))
;
val LineFill_def = Def
  ("LineFill",
   TP[Var("h",LTy(PTy(CTy"actions",PTy(nTy,FTy 48)))),Var("li",FTy 48),
      Var("t",FTy 48),Var("pm",ATy(FTy 48,F8)),
      Var("dc",ATy(FTy 48,CTy"CSET")),nVar"n"],
   Close
     (qVar"state",
      Let(nVar"v",
          Mop(Cast nTy,
              Dest
                ("DminLine",F4,
                 Dest
                   ("ctr",CTy"CTR",
                    Dest("DC",CTy"CACHE_CONFIG",qVar"state")))),
          Let(Var("s",
                  PTy(ATy(FTy 48,F32),
                      PTy(CTy"SLVAL",
                          PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                              PTy(ATy(FTy 48,CTy"CSET"),
                                  PTy(ATy(FTy 48,F8),qTy)))))),
              Mop(Snd,
                  Apply
                    (For(TP[LN 0,nVar"n",
                            Close
                              (nVar"i",
                               Close
                                 (Var("state0",
                                      PTy(ATy(FTy 48,F32),
                                          PTy(CTy"SLVAL",
                                              PTy(ATy(FTy 48,
                                                      OTy(CTy"SLVAL")),
                                                  PTy(ATy(FTy 48,CTy"CSET"),
                                                      PTy(ATy(FTy 48,F8),
                                                          qTy)))))),
                                  TP[LU,
                                     Fupd
                                       (Mop(Fst,
                                            Var("state0",
                                                PTy(ATy(FTy 48,F32),
                                                    PTy(CTy"SLVAL",
                                                        PTy(ATy(FTy 48,
                                                                OTy(CTy"SLVAL")),
                                                            PTy(ATy(FTy 48,
                                                                    CTy"CSET"),
                                                                PTy(ATy(FTy 48,
                                                                        F8),
                                                                    qTy))))))),
                                        Mop(Cast(FTy 48),nVar"i"),
                                        Apply
                                          (Call
                                             ("CellFill",ATy(FTy 48,F32),
                                              TP[nVar"i",
                                                 Bop(BOr,
                                                     Bop(Lsl,
                                                         Var("t",FTy 48),
                                                         Bop(Add,
                                                             Bop(Add,
                                                                 Mop(Cast
                                                                       nTy,
                                                                     Mop(Log,
                                                                         Bop(Add,
                                                                             Dest
                                                                               ("NumSets",
                                                                                FTy 15,
                                                                                Dest
                                                                                  ("ccsidr",
                                                                                   CTy"CCSIDR",
                                                                                   Dest
                                                                                     ("DC",
                                                                                      CTy"CACHE_CONFIG",
                                                                                      qVar"state"))),
                                                                             LW(1,
                                                                                15)))),
                                                                 nVar"v"),
                                                             LN 2)),
                                                     Bop(Lsl,
                                                         Var("li",FTy 48),
                                                         Bop(Add,nVar"v",
                                                             LN 2))),
                                                 Mop(Fst,
                                                     Mop(Snd,
                                                         Mop(Snd,
                                                             Mop(Snd,
                                                                 Mop(Snd,
                                                                     Var("state0",
                                                                         PTy(ATy(FTy 48,
                                                                                 F32),
                                                                             PTy(CTy"SLVAL",
                                                                                 PTy(ATy(FTy 48,
                                                                                         OTy(CTy"SLVAL")),
                                                                                     PTy(ATy(FTy 48,
                                                                                             CTy"CSET"),
                                                                                         PTy(ATy(FTy 48,
                                                                                                 F8),
                                                                                             qTy)))))))))))]),
                                           Mop(Cast(FTy 48),nVar"i"))),
                                     Mop(Snd,
                                         Var("state0",
                                             PTy(ATy(FTy 48,F32),
                                                 PTy(CTy"SLVAL",
                                                     PTy(ATy(FTy 48,
                                                             OTy(CTy"SLVAL")),
                                                         PTy(ATy(FTy 48,
                                                                 CTy"CSET"),
                                                             PTy(ATy(FTy 48,
                                                                     F8),
                                                                 qTy)))))))]))]),
                     TP[LX(ATy(FTy 48,F32)),LX(CTy"SLVAL"),
                        Dest
                          ("sl",ATy(FTy 48,OTy(CTy"SLVAL")),
                           Apply
                             (Var("dc",ATy(FTy 48,CTy"CSET")),
                              Var("li",FTy 48))),
                        Var("dc",ATy(FTy 48,CTy"CSET")),
                        Var("pm",ATy(FTy 48,F8)),qVar"state"])),
              Let(Var("s",
                      PTy(ATy(FTy 48,F32),
                          PTy(CTy"SLVAL",
                              PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                                  PTy(ATy(FTy 48,CTy"CSET"),
                                      PTy(ATy(FTy 48,F8),qTy)))))),
                  TP[Mop(Fst,
                         Var("s",
                             PTy(ATy(FTy 48,F32),
                                 PTy(CTy"SLVAL",
                                     PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                                         PTy(ATy(FTy 48,CTy"CSET"),
                                             PTy(ATy(FTy 48,F8),qTy))))))),
                     Rupd
                       ("dirty",
                        TP[Mop(Fst,
                               Mop(Snd,
                                   Var("s",
                                       PTy(ATy(FTy 48,F32),
                                           PTy(CTy"SLVAL",
                                               PTy(ATy(FTy 48,
                                                       OTy(CTy"SLVAL")),
                                                   PTy(ATy(FTy 48,
                                                           CTy"CSET"),
                                                       PTy(ATy(FTy 48,F8),
                                                           qTy)))))))),LF]),
                     Mop(Snd,
                         Mop(Snd,
                             Var("s",
                                 PTy(ATy(FTy 48,F32),
                                     PTy(CTy"SLVAL",
                                         PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                                             PTy(ATy(FTy 48,CTy"CSET"),
                                                 PTy(ATy(FTy 48,F8),qTy))))))))],
                  Let(Var("s",
                          PTy(ATy(FTy 48,F32),
                              PTy(CTy"SLVAL",
                                  PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                                      PTy(ATy(FTy 48,CTy"CSET"),
                                          PTy(ATy(FTy 48,F8),qTy)))))),
                      TP[Mop(Fst,
                             Var("s",
                                 PTy(ATy(FTy 48,F32),
                                     PTy(CTy"SLVAL",
                                         PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                                             PTy(ATy(FTy 48,CTy"CSET"),
                                                 PTy(ATy(FTy 48,F8),qTy))))))),
                         Rupd
                           ("value",
                            TP[Mop(Fst,
                                   Mop(Snd,
                                       Var("s",
                                           PTy(ATy(FTy 48,F32),
                                               PTy(CTy"SLVAL",
                                                   PTy(ATy(FTy 48,
                                                           OTy(CTy"SLVAL")),
                                                       PTy(ATy(FTy 48,
                                                               CTy"CSET"),
                                                           PTy(ATy(FTy 48,
                                                                   F8),qTy)))))))),
                               Mop(Fst,
                                   Var("s",
                                       PTy(ATy(FTy 48,F32),
                                           PTy(CTy"SLVAL",
                                               PTy(ATy(FTy 48,
                                                       OTy(CTy"SLVAL")),
                                                   PTy(ATy(FTy 48,
                                                           CTy"CSET"),
                                                       PTy(ATy(FTy 48,F8),
                                                           qTy)))))))]),
                         Mop(Snd,
                             Mop(Snd,
                                 Var("s",
                                     PTy(ATy(FTy 48,F32),
                                         PTy(CTy"SLVAL",
                                             PTy(ATy(FTy 48,
                                                     OTy(CTy"SLVAL")),
                                                 PTy(ATy(FTy 48,CTy"CSET"),
                                                     PTy(ATy(FTy 48,F8),
                                                         qTy))))))))],
                      TP[Fupd
                           (Mop(Fst,
                                Mop(Snd,
                                    Mop(Snd,
                                        Var("s",
                                            PTy(ATy(FTy 48,F32),
                                                PTy(CTy"SLVAL",
                                                    PTy(ATy(FTy 48,
                                                            OTy(CTy"SLVAL")),
                                                        PTy(ATy(FTy 48,
                                                                CTy"CSET"),
                                                            PTy(ATy(FTy 48,
                                                                    F8),
                                                                qTy))))))))),
                            Var("t",FTy 48),
                            Mop(Some,
                                Mop(Fst,
                                    Mop(Snd,
                                        Var("s",
                                            PTy(ATy(FTy 48,F32),
                                                PTy(CTy"SLVAL",
                                                    PTy(ATy(FTy 48,
                                                            OTy(CTy"SLVAL")),
                                                        PTy(ATy(FTy 48,
                                                                CTy"CSET"),
                                                            PTy(ATy(FTy 48,
                                                                    F8),
                                                                qTy)))))))))),
                         LLC([TP[LC("a_lfill",CTy"actions"),
                                 Mop(Cast nTy,Var("t",FTy 48)),
                                 Var("li",FTy 48)]],
                             Var("h",
                                 LTy(PTy(CTy"actions",PTy(nTy,FTy 48)))))]))))))
;
val Hit_def = Def
  ("Hit",
   TP[Var("va",F64),Var("pa",FTy 48),Var("dc",ATy(FTy 48,CTy"CSET"))],
   Close
     (qVar"state",
      Let(TP[Var("li",FTy 48),Var("t",FTy 48),AVar nTy],
          Apply
            (Call
               ("lineSpec",ATy(qTy,PTy(FTy 48,PTy(FTy 48,nTy))),
                TP[Var("va",F64),Var("pa",FTy 48)]),qVar"state"),
          Mop(IsSome,
              Apply
                (Dest
                   ("sl",ATy(FTy 48,OTy(CTy"SLVAL")),
                    Apply
                      (Var("dc",ATy(FTy 48,CTy"CSET")),Var("li",FTy 48))),
                 Var("t",FTy 48))))))
;
val LineDirty_def = Def
  ("LineDirty",
   TP[Var("li",FTy 48),Var("t",FTy 48),Var("dc",ATy(FTy 48,CTy"CSET"))],
   Dest
     ("dirty",bTy,
      Mop(ValOf,
          Apply
            (Dest
               ("sl",ATy(FTy 48,OTy(CTy"SLVAL")),
                Apply(Var("dc",ATy(FTy 48,CTy"CSET")),Var("li",FTy 48))),
             Var("t",FTy 48)))))
;
val lDirty_def = Def
  ("lDirty",
   TP[Var("va",F64),Var("pa",FTy 48),Var("dc",ATy(FTy 48,CTy"CSET"))],
   Close
     (qVar"state",
      CS(Apply
           (Call
              ("lineSpec",ATy(qTy,PTy(FTy 48,PTy(FTy 48,nTy))),
               TP[Var("va",F64),Var("pa",FTy 48)]),qVar"state"),
         [(TP[Var("li",FTy 48),Var("t",FTy 48),AVar nTy],
           Call
             ("LineDirty",bTy,
              TP[Var("li",FTy 48),Var("t",FTy 48),
                 Var("dc",ATy(FTy 48,CTy"CSET"))]))])))
;
val EvictAlias_def = Def
  ("EvictAlias",
   TP[Var("va",F64),Var("pa",FTy 48),Var("pm",ATy(FTy 48,F8)),
      Var("dc",ATy(FTy 48,CTy"CSET"))],
   Close
     (qVar"state",
      Let(TP[Var("v",OTy(FTy 48)),
             Var("s",PTy(ATy(FTy 48,CTy"CSET"),PTy(ATy(FTy 48,F8),qTy)))],
          TP[Apply
               (Call
                  ("Alias",ATy(qTy,OTy(FTy 48)),
                   TP[Var("va",F64),Var("pa",FTy 48),
                      Var("dc",ATy(FTy 48,CTy"CSET"))]),qVar"state"),
             Var("dc",ATy(FTy 48,CTy"CSET")),Var("pm",ATy(FTy 48,F8)),
             qVar"state"],
          Let(TP[Var("v0",PTy(FTy 48,PTy(FTy 48,nTy))),
                 Var("s",
                     PTy(ATy(FTy 48,CTy"CSET"),PTy(ATy(FTy 48,F8),qTy)))],
              Let(TP[Var("v",PTy(FTy 48,PTy(FTy 48,nTy))),
                     Var("s3",PTy(ATy(FTy 48,F8),qTy))],
                  Let(TP[Var("v",PTy(FTy 48,PTy(FTy 48,nTy))),qVar"s3"],
                      Let(qVar"s0",
                          Mop(Snd,
                              Mop(Snd,
                                  Var("s",
                                      PTy(ATy(FTy 48,CTy"CSET"),
                                          PTy(ATy(FTy 48,F8),qTy))))),
                          TP[Apply
                               (Call
                                  ("lineSpec",
                                   ATy(qTy,PTy(FTy 48,PTy(FTy 48,nTy))),
                                   TP[Var("va",F64),Var("pa",FTy 48)]),
                                qVar"s0"),qVar"s0"]),
                      TP[Var("v",PTy(FTy 48,PTy(FTy 48,nTy))),
                         Mop(Fst,
                             Mop(Snd,
                                 Var("s",
                                     PTy(ATy(FTy 48,CTy"CSET"),
                                         PTy(ATy(FTy 48,F8),qTy))))),
                         qVar"s3"]),
                  TP[Var("v",PTy(FTy 48,PTy(FTy 48,nTy))),
                     Mop(Fst,
                         Var("s",
                             PTy(ATy(FTy 48,CTy"CSET"),
                                 PTy(ATy(FTy 48,F8),qTy)))),
                     Var("s3",PTy(ATy(FTy 48,F8),qTy))]),
              Let(TP[AVar(FTy 48),Var("t",FTy 48),AVar nTy],
                  Var("v0",PTy(FTy 48,PTy(FTy 48,nTy))),
                  ITE(Mop(IsSome,Var("v",OTy(FTy 48))),
                      Let(Var("li",FTy 48),
                          Mop(ValOf,Var("v",OTy(FTy 48))),
                          Let(TP[Var("v",
                                     PTy(ATy(FTy 48,CTy"CSET"),
                                         ATy(FTy 48,F8))),
                                 Var("s",
                                     PTy(ATy(FTy 48,CTy"CSET"),
                                         PTy(ATy(FTy 48,F8),qTy)))],
                              Let(TP[Var("v",
                                         PTy(ATy(FTy 48,CTy"CSET"),
                                             ATy(FTy 48,F8))),
                                     Var("s3",PTy(ATy(FTy 48,F8),qTy))],
                                  Let(TP[Var("v",
                                             PTy(ATy(FTy 48,CTy"CSET"),
                                                 ATy(FTy 48,F8))),qVar"s3"],
                                      Let(qVar"s0",
                                          Mop(Snd,
                                              Mop(Snd,
                                                  Var("s",
                                                      PTy(ATy(FTy 48,
                                                              CTy"CSET"),
                                                          PTy(ATy(FTy 48,
                                                                  F8),qTy))))),
                                          TP[Apply
                                               (Call
                                                  ("WriteBackLine",
                                                   ATy(qTy,
                                                       PTy(ATy(FTy 48,
                                                               CTy"CSET"),
                                                           ATy(FTy 48,F8))),
                                                   TP[Var("li",FTy 48),
                                                      Var("t",FTy 48),
                                                      Mop(Fst,
                                                          Mop(Snd,
                                                              Var("s",
                                                                  PTy(ATy(FTy 48,
                                                                          CTy"CSET"),
                                                                      PTy(ATy(FTy 48,
                                                                              F8),
                                                                          qTy))))),
                                                      Mop(Fst,
                                                          Var("s",
                                                              PTy(ATy(FTy 48,
                                                                      CTy"CSET"),
                                                                  PTy(ATy(FTy 48,
                                                                          F8),
                                                                      qTy)))),
                                                      Bop(Sub,
                                                          Bop(Exp,LN 2,
                                                              Mop(Cast nTy,
                                                                  Dest
                                                                    ("DminLine",
                                                                     F4,
                                                                     Dest
                                                                       ("ctr",
                                                                        CTy"CTR",
                                                                        Dest
                                                                          ("DC",
                                                                           CTy"CACHE_CONFIG",
                                                                           Mop(Snd,
                                                                               Mop(Snd,
                                                                                   Var("s",
                                                                                       PTy(ATy(FTy 48,
                                                                                               CTy"CSET"),
                                                                                           PTy(ATy(FTy 48,
                                                                                                   F8),
                                                                                               qTy)))))))))),
                                                          LN 1)]),qVar"s0"),
                                             qVar"s0"]),
                                      TP[Var("v",
                                             PTy(ATy(FTy 48,CTy"CSET"),
                                                 ATy(FTy 48,F8))),
                                         Mop(Fst,
                                             Mop(Snd,
                                                 Var("s",
                                                     PTy(ATy(FTy 48,
                                                             CTy"CSET"),
                                                         PTy(ATy(FTy 48,F8),
                                                             qTy))))),
                                         qVar"s3"]),
                                  TP[Var("v",
                                         PTy(ATy(FTy 48,CTy"CSET"),
                                             ATy(FTy 48,F8))),
                                     Mop(Fst,
                                         Var("s",
                                             PTy(ATy(FTy 48,CTy"CSET"),
                                                 PTy(ATy(FTy 48,F8),qTy)))),
                                     Var("s3",PTy(ATy(FTy 48,F8),qTy))]),
                              Let(TP[Var("ca",ATy(FTy 48,CTy"CSET")),
                                     Var("mm",ATy(FTy 48,F8))],
                                  Var("v",
                                      PTy(ATy(FTy 48,CTy"CSET"),
                                          ATy(FTy 48,F8))),
                                  Let(TP[Var("cacheSl",
                                             ATy(FTy 48,OTy(CTy"SLVAL"))),
                                         Var("cacheH",
                                             LTy(PTy(CTy"actions",
                                                     PTy(nTy,FTy 48))))],
                                      Call
                                        ("Evict",
                                         PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                                             LTy(PTy(CTy"actions",
                                                     PTy(nTy,FTy 48)))),
                                         TP[Dest
                                              ("hist",
                                               LTy(PTy(CTy"actions",
                                                       PTy(nTy,FTy 48))),
                                               Apply
                                                 (Var("ca",
                                                      ATy(FTy 48,CTy"CSET")),
                                                  Var("li",FTy 48))),
                                            Var("li",FTy 48),
                                            Var("t",FTy 48),
                                            Var("ca",ATy(FTy 48,CTy"CSET"))]),
                                      Let(Var("s0",ATy(FTy 48,CTy"CSET")),
                                          Fupd
                                            (Var("ca",
                                                 ATy(FTy 48,CTy"CSET")),
                                             Var("li",FTy 48),
                                             Rupd
                                               ("sl",
                                                TP[Apply
                                                     (Var("ca",
                                                          ATy(FTy 48,
                                                              CTy"CSET")),
                                                      Var("li",FTy 48)),
                                                   Var("cacheSl",
                                                       ATy(FTy 48,
                                                           OTy(CTy"SLVAL")))])),
                                          TP[Fupd
                                               (Var("s0",
                                                    ATy(FTy 48,CTy"CSET")),
                                                Var("li",FTy 48),
                                                Rupd
                                                  ("hist",
                                                   TP[Apply
                                                        (Var("s0",
                                                             ATy(FTy 48,
                                                                 CTy"CSET")),
                                                         Var("li",FTy 48)),
                                                      Var("cacheH",
                                                          LTy(PTy(CTy"actions",
                                                                  PTy(nTy,
                                                                      FTy 48))))])),
                                             Var("mm",ATy(FTy 48,F8))]))))),
                      TP[Mop(Fst,
                             Var("s",
                                 PTy(ATy(FTy 48,CTy"CSET"),
                                     PTy(ATy(FTy 48,F8),qTy)))),
                         Mop(Fst,
                             Mop(Snd,
                                 Var("s",
                                     PTy(ATy(FTy 48,CTy"CSET"),
                                         PTy(ATy(FTy 48,F8),qTy)))))]))))))
;
val CacheInvalidateByAdr_def = Def
  ("CacheInvalidateByAdr",
   TP[Var("va",F64),Var("pa",FTy 48),Var("pm",ATy(FTy 48,F8)),
      Var("dc",ATy(FTy 48,CTy"CSET"))],
   Close
     (qVar"state",
      Let(TP[Var("li",FTy 48),Var("t",FTy 48),AVar nTy],
          Apply
            (Call
               ("lineSpec",ATy(qTy,PTy(FTy 48,PTy(FTy 48,nTy))),
                TP[Var("va",F64),Var("pa",FTy 48)]),qVar"state"),
          Let(Var("s",PTy(ATy(FTy 48,CTy"CSET"),PTy(ATy(FTy 48,F8),qTy))),
              ITE(Apply
                    (Call
                       ("Hit",ATy(qTy,bTy),
                        TP[Var("va",F64),Var("pa",FTy 48),
                           Var("dc",ATy(FTy 48,CTy"CSET"))]),qVar"state"),
                  Let(TP[Var("ca",ATy(FTy 48,CTy"CSET")),
                         Var("mm",ATy(FTy 48,F8))],
                      Apply
                        (Call
                           ("WriteBackLine",
                            ATy(qTy,
                                PTy(ATy(FTy 48,CTy"CSET"),ATy(FTy 48,F8))),
                            TP[Var("li",FTy 48),Var("t",FTy 48),
                               Var("pm",ATy(FTy 48,F8)),
                               Var("dc",ATy(FTy 48,CTy"CSET")),
                               Bop(Sub,
                                   Bop(Exp,LN 2,
                                       Mop(Cast nTy,
                                           Dest
                                             ("DminLine",F4,
                                              Dest
                                                ("ctr",CTy"CTR",
                                                 Dest
                                                   ("DC",
                                                    CTy"CACHE_CONFIG",
                                                    qVar"state"))))),LN 1)]),
                         qVar"state"),
                      Let(TP[Var("cacheSl",ATy(FTy 48,OTy(CTy"SLVAL"))),
                             Var("cacheH",
                                 LTy(PTy(CTy"actions",PTy(nTy,FTy 48))))],
                          Call
                            ("Evict",
                             PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                                 LTy(PTy(CTy"actions",PTy(nTy,FTy 48)))),
                             TP[Dest
                                  ("hist",
                                   LTy(PTy(CTy"actions",PTy(nTy,FTy 48))),
                                   Apply
                                     (Var("ca",ATy(FTy 48,CTy"CSET")),
                                      Var("li",FTy 48))),Var("li",FTy 48),
                                Var("t",FTy 48),
                                Var("ca",ATy(FTy 48,CTy"CSET"))]),
                          Let(Var("s3",ATy(FTy 48,CTy"CSET")),
                              Fupd
                                (Var("ca",ATy(FTy 48,CTy"CSET")),
                                 Var("li",FTy 48),
                                 Rupd
                                   ("sl",
                                    TP[Apply
                                         (Var("ca",ATy(FTy 48,CTy"CSET")),
                                          Var("li",FTy 48)),
                                       Var("cacheSl",
                                           ATy(FTy 48,OTy(CTy"SLVAL")))])),
                              TP[Fupd
                                   (Var("s3",ATy(FTy 48,CTy"CSET")),
                                    Var("li",FTy 48),
                                    Rupd
                                      ("hist",
                                       TP[Apply
                                            (Var("s3",
                                                 ATy(FTy 48,CTy"CSET")),
                                             Var("li",FTy 48)),
                                          Var("cacheH",
                                              LTy(PTy(CTy"actions",
                                                      PTy(nTy,FTy 48))))])),
                                 Var("mm",ATy(FTy 48,F8)),qVar"state"]))),
                  TP[Var("dc",ATy(FTy 48,CTy"CSET")),
                     Var("pm",ATy(FTy 48,F8)),qVar"state"]),
              TP[Mop(Fst,
                     Var("s",
                         PTy(ATy(FTy 48,CTy"CSET"),PTy(ATy(FTy 48,F8),qTy)))),
                 Mop(Fst,
                     Mop(Snd,
                         Var("s",
                             PTy(ATy(FTy 48,CTy"CSET"),
                                 PTy(ATy(FTy 48,F8),qTy)))))]))))
;
val CacheCleanByAdr_def = Def
  ("CacheCleanByAdr",
   TP[Var("va",F64),Var("pa",FTy 48),Var("pm",ATy(FTy 48,F8)),
      Var("dc",ATy(FTy 48,CTy"CSET"))],
   Close
     (qVar"state",
      Let(TP[Var("li",FTy 48),Var("t",FTy 48),AVar nTy],
          Apply
            (Call
               ("lineSpec",ATy(qTy,PTy(FTy 48,PTy(FTy 48,nTy))),
                TP[Var("va",F64),Var("pa",FTy 48)]),qVar"state"),
          Let(Var("s",PTy(ATy(FTy 48,CTy"CSET"),PTy(ATy(FTy 48,F8),qTy))),
              ITE(Apply
                    (Call
                       ("Hit",ATy(qTy,bTy),
                        TP[Var("va",F64),Var("pa",FTy 48),
                           Var("dc",ATy(FTy 48,CTy"CSET"))]),qVar"state"),
                  Let(TP[Var("ca",ATy(FTy 48,CTy"CSET")),
                         Var("mm",ATy(FTy 48,F8))],
                      Apply
                        (Call
                           ("WriteBackLine",
                            ATy(qTy,
                                PTy(ATy(FTy 48,CTy"CSET"),ATy(FTy 48,F8))),
                            TP[Var("li",FTy 48),Var("t",FTy 48),
                               Var("pm",ATy(FTy 48,F8)),
                               Var("dc",ATy(FTy 48,CTy"CSET")),
                               Bop(Sub,
                                   Bop(Exp,LN 2,
                                       Mop(Cast nTy,
                                           Dest
                                             ("DminLine",F4,
                                              Dest
                                                ("ctr",CTy"CTR",
                                                 Dest
                                                   ("DC",
                                                    CTy"CACHE_CONFIG",
                                                    qVar"state"))))),LN 1)]),
                         qVar"state"),
                      TP[Var("ca",ATy(FTy 48,CTy"CSET")),
                         Var("mm",ATy(FTy 48,F8)),qVar"state"]),
                  TP[Var("dc",ATy(FTy 48,CTy"CSET")),
                     Var("pm",ATy(FTy 48,F8)),qVar"state"]),
              TP[Mop(Fst,
                     Var("s",
                         PTy(ATy(FTy 48,CTy"CSET"),PTy(ATy(FTy 48,F8),qTy)))),
                 Mop(Fst,
                     Mop(Snd,
                         Var("s",
                             PTy(ATy(FTy 48,CTy"CSET"),
                                 PTy(ATy(FTy 48,F8),qTy)))))]))))
;
val Fill_def = Def
  ("Fill",
   TP[Var("va",F64),Var("pa",FTy 48),Var("pm",ATy(FTy 48,F8)),
      Var("dc",ATy(FTy 48,CTy"CSET"))],
   Close
     (qVar"state",
      Let(nVar"v",
          Bop(Sub,
              Bop(Exp,LN 2,
                  Mop(Cast nTy,
                      Dest
                        ("DminLine",F4,
                         Dest
                           ("ctr",CTy"CTR",
                            Dest("DC",CTy"CACHE_CONFIG",qVar"state"))))),
              LN 1),
          Let(TP[Var("li",FTy 48),Var("t",FTy 48),AVar nTy],
              Apply
                (Call
                   ("lineSpec",ATy(qTy,PTy(FTy 48,PTy(FTy 48,nTy))),
                    TP[Var("va",F64),Var("pa",FTy 48)]),qVar"state"),
              Let(Var("s",
                      PTy(ATy(FTy 48,CTy"CSET"),PTy(ATy(FTy 48,F8),qTy))),
                  CS(Call
                       ("EP",OTy(FTy 48),
                        TP[Dest
                             ("hist",
                              LTy(PTy(CTy"actions",PTy(nTy,FTy 48))),
                              Apply
                                (Var("dc",ATy(FTy 48,CTy"CSET")),
                                 Var("li",FTy 48))),Var("t",FTy 48),
                           Var("dc",ATy(FTy 48,CTy"CSET"))]),
                     [(Mop(Some,Var("et",FTy 48)),
                       Let(TP[Var("ca",ATy(FTy 48,CTy"CSET")),
                              Var("mm",ATy(FTy 48,F8))],
                           Apply
                             (Call
                                ("WriteBackLine",
                                 ATy(qTy,
                                     PTy(ATy(FTy 48,CTy"CSET"),
                                         ATy(FTy 48,F8))),
                                 TP[Var("li",FTy 48),Var("et",FTy 48),
                                    Var("pm",ATy(FTy 48,F8)),
                                    Var("dc",ATy(FTy 48,CTy"CSET")),
                                    nVar"v"]),qVar"state"),
                           Let(TP[Var("sl",ATy(FTy 48,OTy(CTy"SLVAL"))),
                                  Var("h",
                                      LTy(PTy(CTy"actions",PTy(nTy,FTy 48))))],
                               Call
                                 ("Evict",
                                  PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                                      LTy(PTy(CTy"actions",PTy(nTy,FTy 48)))),
                                  TP[Dest
                                       ("hist",
                                        LTy(PTy(CTy"actions",
                                                PTy(nTy,FTy 48))),
                                        Apply
                                          (Var("ca",ATy(FTy 48,CTy"CSET")),
                                           Var("li",FTy 48))),
                                     Var("li",FTy 48),Var("et",FTy 48),
                                     Var("ca",ATy(FTy 48,CTy"CSET"))]),
                               Let(Var("s3",ATy(FTy 48,CTy"CSET")),
                                   Fupd
                                     (Var("ca",ATy(FTy 48,CTy"CSET")),
                                      Var("li",FTy 48),
                                      Rupd
                                        ("sl",
                                         TP[Apply
                                              (Var("ca",
                                                   ATy(FTy 48,CTy"CSET")),
                                               Var("li",FTy 48)),
                                            Var("sl",
                                                ATy(FTy 48,OTy(CTy"SLVAL")))])),
                                   Let(Var("s0",ATy(FTy 48,CTy"CSET")),
                                       Fupd
                                         (Var("s3",ATy(FTy 48,CTy"CSET")),
                                          Var("li",FTy 48),
                                          Rupd
                                            ("hist",
                                             TP[Apply
                                                  (Var("s3",
                                                       ATy(FTy 48,
                                                           CTy"CSET")),
                                                   Var("li",FTy 48)),
                                                Var("h",
                                                    LTy(PTy(CTy"actions",
                                                            PTy(nTy,FTy 48))))])),
                                       Let(TP[Var("sl",
                                                  ATy(FTy 48,
                                                      OTy(CTy"SLVAL"))),
                                              Var("h",
                                                  LTy(PTy(CTy"actions",
                                                          PTy(nTy,FTy 48))))],
                                           Apply
                                             (Call
                                                ("LineFill",
                                                 ATy(qTy,
                                                     PTy(ATy(FTy 48,
                                                             OTy(CTy"SLVAL")),
                                                         LTy(PTy(CTy"actions",
                                                                 PTy(nTy,
                                                                     FTy 48))))),
                                                 TP[Dest
                                                      ("hist",
                                                       LTy(PTy(CTy"actions",
                                                               PTy(nTy,
                                                                   FTy 48))),
                                                       Apply
                                                         (Var("s0",
                                                              ATy(FTy 48,
                                                                  CTy"CSET")),
                                                          Var("li",FTy 48))),
                                                    Var("li",FTy 48),
                                                    Var("t",FTy 48),
                                                    Var("mm",
                                                        ATy(FTy 48,F8)),
                                                    Var("s0",
                                                        ATy(FTy 48,
                                                            CTy"CSET")),
                                                    nVar"v"]),qVar"state"),
                                           Let(Var("s0",
                                                   ATy(FTy 48,CTy"CSET")),
                                               Fupd
                                                 (Var("s0",
                                                      ATy(FTy 48,CTy"CSET")),
                                                  Var("li",FTy 48),
                                                  Rupd
                                                    ("sl",
                                                     TP[Apply
                                                          (Var("s0",
                                                               ATy(FTy 48,
                                                                   CTy"CSET")),
                                                           Var("li",FTy 48)),
                                                        Var("sl",
                                                            ATy(FTy 48,
                                                                OTy(CTy"SLVAL")))])),
                                               TP[Fupd
                                                    (Var("s0",
                                                         ATy(FTy 48,
                                                             CTy"CSET")),
                                                     Var("li",FTy 48),
                                                     Rupd
                                                       ("hist",
                                                        TP[Apply
                                                             (Var("s0",
                                                                  ATy(FTy 48,
                                                                      CTy"CSET")),
                                                              Var("li",
                                                                  FTy 48)),
                                                           Var("h",
                                                               LTy(PTy(CTy"actions",
                                                                       PTy(nTy,
                                                                           FTy 48))))])),
                                                  Var("mm",ATy(FTy 48,F8)),
                                                  qVar"state"]))))))),
                      (AVar(OTy(FTy 48)),
                       Let(TP[Var("sl",ATy(FTy 48,OTy(CTy"SLVAL"))),
                              Var("h",
                                  LTy(PTy(CTy"actions",PTy(nTy,FTy 48))))],
                           Apply
                             (Call
                                ("LineFill",
                                 ATy(qTy,
                                     PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                                         LTy(PTy(CTy"actions",
                                                 PTy(nTy,FTy 48))))),
                                 TP[Dest
                                      ("hist",
                                       LTy(PTy(CTy"actions",
                                               PTy(nTy,FTy 48))),
                                       Apply
                                         (Var("dc",ATy(FTy 48,CTy"CSET")),
                                          Var("li",FTy 48))),
                                    Var("li",FTy 48),Var("t",FTy 48),
                                    Var("pm",ATy(FTy 48,F8)),
                                    Var("dc",ATy(FTy 48,CTy"CSET")),
                                    nVar"v"]),qVar"state"),
                           Let(Var("s0",ATy(FTy 48,CTy"CSET")),
                               Fupd
                                 (Var("dc",ATy(FTy 48,CTy"CSET")),
                                  Var("li",FTy 48),
                                  Rupd
                                    ("sl",
                                     TP[Apply
                                          (Var("dc",ATy(FTy 48,CTy"CSET")),
                                           Var("li",FTy 48)),
                                        Var("sl",
                                            ATy(FTy 48,OTy(CTy"SLVAL")))])),
                               TP[Fupd
                                    (Var("s0",ATy(FTy 48,CTy"CSET")),
                                     Var("li",FTy 48),
                                     Rupd
                                       ("hist",
                                        TP[Apply
                                             (Var("s0",
                                                  ATy(FTy 48,CTy"CSET")),
                                              Var("li",FTy 48)),
                                           Var("h",
                                               LTy(PTy(CTy"actions",
                                                       PTy(nTy,FTy 48))))])),
                                  Var("pm",ATy(FTy 48,F8)),qVar"state"])))]),
                  TP[Mop(Fst,
                         Var("s",
                             PTy(ATy(FTy 48,CTy"CSET"),
                                 PTy(ATy(FTy 48,F8),qTy)))),
                     Mop(Fst,
                         Mop(Snd,
                             Var("s",
                                 PTy(ATy(FTy 48,CTy"CSET"),
                                     PTy(ATy(FTy 48,F8),qTy)))))])))))
;
val CellRead_def = Def
  ("CellRead",
   TP[Var("i",FTy 48),Var("t",FTy 48),nVar"wi",
      Var("dc",ATy(FTy 48,CTy"CSET"))],
   Apply
     (Dest
        ("value",ATy(FTy 48,F32),
         Mop(ValOf,
             Apply
               (Dest
                  ("sl",ATy(FTy 48,OTy(CTy"SLVAL")),
                   Apply(Var("dc",ATy(FTy 48,CTy"CSET")),Var("i",FTy 48))),
                Var("t",FTy 48)))),Mop(Cast(FTy 48),nVar"wi")))
;
val CacheRead_def = Def
  ("CacheRead",
   TP[Var("va",F64),Var("pa",FTy 48),Var("pm",ATy(FTy 48,F8)),
      Var("dc",ATy(FTy 48,CTy"CSET"))],
   Close
     (qVar"state",
      Let(TP[Var("li",FTy 48),Var("t",FTy 48),nVar"wi"],
          Apply
            (Call
               ("lineSpec",ATy(qTy,PTy(FTy 48,PTy(FTy 48,nTy))),
                TP[Var("va",F64),Var("pa",FTy 48)]),qVar"state"),
          ITE(Apply
                (Call
                   ("Hit",ATy(qTy,bTy),
                    TP[Var("va",F64),Var("pa",FTy 48),
                       Var("dc",ATy(FTy 48,CTy"CSET"))]),qVar"state"),
              Let(TP[Var("cset",ATy(FTy 48,OTy(CTy"SLVAL"))),
                     Var("cacheH",LTy(PTy(CTy"actions",PTy(nTy,FTy 48))))],
                  Call
                    ("Touch",
                     PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                         LTy(PTy(CTy"actions",PTy(nTy,FTy 48)))),
                     TP[Dest
                          ("hist",LTy(PTy(CTy"actions",PTy(nTy,FTy 48))),
                           Apply
                             (Var("dc",ATy(FTy 48,CTy"CSET")),
                              Var("li",FTy 48))),Var("li",FTy 48),
                        Var("t",FTy 48),Mop(Cast(FTy 48),nVar"wi"),
                        LO(CTy"wrTyp"),Var("dc",ATy(FTy 48,CTy"CSET"))]),
                  TP[Fupd
                       (Var("dc",ATy(FTy 48,CTy"CSET")),Var("li",FTy 48),
                        Rupd
                          ("hist",
                           TP[Apply
                                (Var("dc",ATy(FTy 48,CTy"CSET")),
                                 Var("li",FTy 48)),
                              Var("cacheH",
                                  LTy(PTy(CTy"actions",PTy(nTy,FTy 48))))])),
                     Var("pm",ATy(FTy 48,F8)),
                     Mop(Cast vTy,
                         Apply
                           (Dest
                              ("value",ATy(FTy 48,F32),
                               Mop(ValOf,
                                   Apply
                                     (Var("cset",
                                          ATy(FTy 48,OTy(CTy"SLVAL"))),
                                      Var("t",FTy 48)))),
                            Mop(Cast(FTy 48),nVar"wi")))]),
              Let(TP[Var("ca",ATy(FTy 48,CTy"CSET")),
                     Var("mm",ATy(FTy 48,F8))],
                  Apply
                    (Call
                       ("Fill",
                        ATy(qTy,PTy(ATy(FTy 48,CTy"CSET"),ATy(FTy 48,F8))),
                        TP[Var("va",F64),Var("pa",FTy 48),
                           Var("pm",ATy(FTy 48,F8)),
                           Var("dc",ATy(FTy 48,CTy"CSET"))]),qVar"state"),
                  TP[Fupd
                       (Var("ca",ATy(FTy 48,CTy"CSET")),Var("li",FTy 48),
                        Rupd
                          ("hist",
                           TP[Apply
                                (Var("ca",ATy(FTy 48,CTy"CSET")),
                                 Var("li",FTy 48)),
                              LLC([TP[LC("a_read",CTy"actions"),
                                      Mop(Cast nTy,Var("t",FTy 48)),
                                      Var("li",FTy 48)]],
                                  Dest
                                    ("hist",
                                     LTy(PTy(CTy"actions",PTy(nTy,FTy 48))),
                                     Apply
                                       (Var("ca",ATy(FTy 48,CTy"CSET")),
                                        Var("li",FTy 48))))])),
                     Var("mm",ATy(FTy 48,F8)),
                     Mop(Cast vTy,
                         Apply
                           (Dest
                              ("value",ATy(FTy 48,F32),
                               Mop(ValOf,
                                   Apply
                                     (Dest
                                        ("sl",ATy(FTy 48,OTy(CTy"SLVAL")),
                                         Apply
                                           (Var("ca",ATy(FTy 48,CTy"CSET")),
                                            Var("li",FTy 48))),
                                      Var("t",FTy 48)))),
                            Mop(Cast(FTy 48),nVar"wi")))])))))
;
val CacheWrite_def = Def
  ("CacheWrite",
   TP[Var("va",F64),Var("pa",FTy 48),Var("data",CTy"wrTyp"),
      Var("pm",ATy(FTy 48,F8)),Var("dc",ATy(FTy 48,CTy"CSET"))],
   Close
     (qVar"state",
      Let(TP[Var("li",FTy 48),Var("t",FTy 48),nVar"wi"],
          Apply
            (Call
               ("lineSpec",ATy(qTy,PTy(FTy 48,PTy(FTy 48,nTy))),
                TP[Var("va",F64),Var("pa",FTy 48)]),qVar"state"),
          ITE(Apply
                (Call
                   ("Hit",ATy(qTy,bTy),
                    TP[Var("va",F64),Var("pa",FTy 48),
                       Var("dc",ATy(FTy 48,CTy"CSET"))]),qVar"state"),
              Let(TP[Var("cacheSl",ATy(FTy 48,OTy(CTy"SLVAL"))),
                     Var("cacheH",LTy(PTy(CTy"actions",PTy(nTy,FTy 48))))],
                  Call
                    ("Touch",
                     PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                         LTy(PTy(CTy"actions",PTy(nTy,FTy 48)))),
                     TP[Dest
                          ("hist",LTy(PTy(CTy"actions",PTy(nTy,FTy 48))),
                           Apply
                             (Var("dc",ATy(FTy 48,CTy"CSET")),
                              Var("li",FTy 48))),Var("li",FTy 48),
                        Var("t",FTy 48),Mop(Cast(FTy 48),nVar"wi"),
                        Mop(Some,Var("data",CTy"wrTyp")),
                        Var("dc",ATy(FTy 48,CTy"CSET"))]),
                  Let(Var("s0",ATy(FTy 48,CTy"CSET")),
                      Fupd
                        (Var("dc",ATy(FTy 48,CTy"CSET")),Var("li",FTy 48),
                         Rupd
                           ("sl",
                            TP[Apply
                                 (Var("dc",ATy(FTy 48,CTy"CSET")),
                                  Var("li",FTy 48)),
                               Var("cacheSl",ATy(FTy 48,OTy(CTy"SLVAL")))])),
                      TP[Fupd
                           (Var("s0",ATy(FTy 48,CTy"CSET")),
                            Var("li",FTy 48),
                            Rupd
                              ("hist",
                               TP[Apply
                                    (Var("s0",ATy(FTy 48,CTy"CSET")),
                                     Var("li",FTy 48)),
                                  Var("cacheH",
                                      LTy(PTy(CTy"actions",PTy(nTy,FTy 48))))])),
                         Var("pm",ATy(FTy 48,F8))])),
              Let(TP[Var("ca",ATy(FTy 48,CTy"CSET")),
                     Var("mm",ATy(FTy 48,F8))],
                  Apply
                    (Call
                       ("Fill",
                        ATy(qTy,PTy(ATy(FTy 48,CTy"CSET"),ATy(FTy 48,F8))),
                        TP[Var("va",F64),Var("pa",FTy 48),
                           Var("pm",ATy(FTy 48,F8)),
                           Var("dc",ATy(FTy 48,CTy"CSET"))]),qVar"state"),
                  Let(TP[Var("cacheSl",ATy(FTy 48,OTy(CTy"SLVAL"))),
                         Var("cacheH",
                             LTy(PTy(CTy"actions",PTy(nTy,FTy 48))))],
                      Call
                        ("Touch",
                         PTy(ATy(FTy 48,OTy(CTy"SLVAL")),
                             LTy(PTy(CTy"actions",PTy(nTy,FTy 48)))),
                         TP[Dest
                              ("hist",
                               LTy(PTy(CTy"actions",PTy(nTy,FTy 48))),
                               Apply
                                 (Var("ca",ATy(FTy 48,CTy"CSET")),
                                  Var("li",FTy 48))),Var("li",FTy 48),
                            Var("t",FTy 48),Mop(Cast(FTy 48),nVar"wi"),
                            Mop(Some,Var("data",CTy"wrTyp")),
                            Var("ca",ATy(FTy 48,CTy"CSET"))]),
                      Let(Var("s0",ATy(FTy 48,CTy"CSET")),
                          Fupd
                            (Var("dc",ATy(FTy 48,CTy"CSET")),
                             Var("li",FTy 48),
                             Rupd
                               ("sl",
                                TP[Apply
                                     (Var("dc",ATy(FTy 48,CTy"CSET")),
                                      Var("li",FTy 48)),
                                   Var("cacheSl",
                                       ATy(FTy 48,OTy(CTy"SLVAL")))])),
                          TP[Fupd
                               (Var("s0",ATy(FTy 48,CTy"CSET")),
                                Var("li",FTy 48),
                                Rupd
                                  ("hist",
                                   TP[Apply
                                        (Var("s0",ATy(FTy 48,CTy"CSET")),
                                         Var("li",FTy 48)),
                                      Var("cacheH",
                                          LTy(PTy(CTy"actions",
                                                  PTy(nTy,FTy 48))))])),
                             Var("mm",ATy(FTy 48,F8))])))))))
;
val mv_def = Def
  ("mv",
   TP[bVar"cbl",Var("va",F64),Var("pa",FTy 48),Var("pm",ATy(FTy 48,F8)),
      Var("dc",ATy(FTy 48,CTy"CSET"))],
   Close
     (qVar"state",
      ITE(bVar"cbl",
          Call
            ("read_mem32",vTy,
             TP[Var("pa",FTy 48),Var("pm",ATy(FTy 48,F8))]),
          CS(Apply
               (Call
                  ("CacheRead",
                   ATy(qTy,
                       PTy(ATy(FTy 48,CTy"CSET"),PTy(ATy(FTy 48,F8),vTy))),
                   TP[Var("va",F64),Var("pa",FTy 48),
                      Var("pm",ATy(FTy 48,F8)),
                      Var("dc",ATy(FTy 48,CTy"CSET"))]),qVar"state"),
             [(TP[Var("c",ATy(FTy 48,CTy"CSET")),Var("m",ATy(FTy 48,F8)),
                  vVar"vl"],vVar"vl")]))))

val () = Import.finish 1